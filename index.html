<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Work Athlete Dashboard</title>
<style>
  :root {
    --bg: #ffffff;
    --fg: #111111;
    --muted: #666666;
    --border: #e7e7e7;
    --accent: #8f4dcc;   /* Brandwell purple */
    --accent-2: #2ec4b6; /* Teal */
    --radius: 12px;
    --shadow: 0 6px 24px rgba(0,0,0,0.06);
    --container: 900px;
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    --sans: Inter, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, sans-serif;
  }

  * { box-sizing: border-box; }

  html, body {
    background: var(--bg);
    color: var(--fg);
    font-family: var(--sans);
    line-height: 1.55;
    margin: 0;
  }

  header {
    padding: 2rem 1.25rem 1rem;
    border-bottom: 1px solid var(--border);
    background: #fafafa;
  }

  h1 {
    margin: 0 0 0.35rem;
    font-size: clamp(1.6rem, 3.4vw, 2.2rem);
  }

  .date {
    color: var(--muted);
    font-size: 0.95rem;
  }

  main {
    max-width: var(--container);
    margin: 0 auto;
    padding: 2rem 1.25rem 6rem;
  }

  .actions {
    display: flex;
    flex-wrap: wrap;
    gap: .6rem;
    margin: 1.2rem 0 2rem;
  }

  button, .btn {
    border: 1px solid var(--border);
    border-radius: var(--radius);
    background: #fff;
    color: var(--fg);
    padding: 0.65rem 1rem;
    font-weight: 600;
    cursor: pointer;
    box-shadow: var(--shadow);
    transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
  }
  button:hover, .btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 8px 28px rgba(0,0,0,.08);
    border-color: var(--accent);
  }

  button.primary {
    background: var(--accent);
    border-color: var(--accent);
    color: #fff;
  }
  button.primary:hover {
    box-shadow: 0 8px 28px rgba(143,77,204,0.25);
  }

  button.outline-danger {
    border-color: #ff4d4f33;
    color: #ff4d4f;
    background: #fff;
  }

  .set {
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 1rem 1rem 0.75rem;
    margin-bottom: 1rem;
    background: #fff;
  }

  .set-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: .75rem;
  }

  .set-title {
    font-weight: 600;
  }

  .set-time {
    font-size: 0.85rem;
    color: var(--muted);
  }

  .checks {
    display: flex;
    gap: 1rem;
    margin: 0.5rem 0 0.75rem;
  }

  .checks label {
    display: flex;
    align-items: center;
    gap: 0.45rem;
    cursor: pointer;
  }

  textarea {
    width: 100%;
    min-height: 90px;
    resize: vertical;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.6rem 0.75rem;
    font-family: var(--sans);
    font-size: 0.95rem;
  }
  textarea:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(143,77,204,0.12);
  }

  .summary {
    margin: 1.8rem 0 2.2rem;
    padding: 1rem;
    border-left: 4px solid var(--accent-2);
    background: #f7fffe;
    border-radius: 6px;
  }

  details.manifesto {
    margin-top: 3rem;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    background: #fff;
  }

  details summary {
    list-style: none;
    cursor: pointer;
    padding: 1rem 1.2rem;
    font-weight: 600;
    border-bottom: 1px solid var(--border);
  }

  details[open] summary {
    border-bottom: 1px solid var(--border);
  }

  details .content {
    padding: 1.2rem 1.2rem 1.8rem;
  }

  .mono {
    font-family: var(--mono);
  }

  /* Print styles for PDF export */
  @media print {
    header, .actions, details.manifesto summary, #motivation-toggle {
      display: none !important;
    }
    body {
      background: #fff !important;
      color: #000;
    }
    main {
      padding: 0 0 0 0;
      max-width: none;
    }
    .set {
      box-shadow: none !important;
      page-break-inside: avoid;
    }
    details.manifesto {
      border: none;
      box-shadow: none;
    }
  }
</style>
</head>
<body>
<header>
  <h1>Work Athlete Dashboard</h1>
  <div class="date" id="todayStr"></div>
</header>

<main>
  <div class="actions">
    <button class="primary" id="addSetBtn">+ Add Set</button>
    <button id="exportBtn">Export Day (PDF)</button>
    <button id="resetBtn" class="outline-danger">Reset Today</button>
  </div>

  <div class="summary" id="summary">
    <!-- Populated by JS -->
  </div>

  <div id="setsContainer"></div>

  <details class="manifesto" id="motivation">
    <summary>Why this system works (Work Athlete Manifesto)</summary>
    <div class="content">
      <h2 style="margin-top:0">The Work Athlete Manifesto</h2>
      <p><strong>Sets build strength. Systems build empires.</strong></p>
      <ol>
        <li><strong>Reps Create Results</strong> — Every 30-minute sprint is a rep for your future self.</li>
        <li><strong>Sets Create Systems</strong> — One set moves the ball. Three sets make a session. Four sessions a day builds the machine.</li>
        <li><strong>Momentum &gt; Motivation</strong> — Start the clock, do the work. The set creates the energy, not the other way around.</li>
        <li><strong>Time, Not Tasks</strong> — Tasks are unpredictable; 30-minute blocks are guaranteed progress.</li>
        <li><strong>Recovery Is Growth</strong> — 5 minutes of movement post-set resets your nervous system and sharpens the next block.</li>
        <li><strong>Fitness + Focus = One Loop</strong> — Work + Workout form a closed, self-reinforcing cycle.</li>
        <li><strong>Structure = Freedom</strong> — 4 sessions = 12 sets = ~6 hours of elite output + 60 minutes of movement.</li>
        <li><strong>Volume Is King</strong> — Consistency > intensity. Reps compound into legacy.</li>
        <li><strong>Consistency Destroys Resistance</strong> — Even on bad days, one set keeps the system alive.</li>
        <li><strong>You Are the Machine</strong> — Refine the loop, refine yourself.</li>
      </ol>
      <p><em>Tagline:</em> <strong>“Reps build strength. Sets build systems. Systems build legacies.”</strong></p>
    </div>
  </details>
</main>

<script>
/**
 * Work Athlete Dashboard MVP
 * - Per-day persistence: localStorage key = 'wa-YYYY-MM-DD'
 * - Fresh slate each new day
 * - Export via window.print()
 */

(function () {
  const todayKey = getTodayKey();
  const storageKey = 'wa-' + todayKey;

  const setsContainer = document.getElementById('setsContainer');
  const addSetBtn = document.getElementById('addSetBtn');
  const exportBtn = document.getElementById('exportBtn');
  const resetBtn = document.getElementById('resetBtn');
  const todayStr = document.getElementById('todayStr');
  const summaryEl = document.getElementById('summary');

  todayStr.textContent = new Date().toLocaleDateString(undefined, {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });

  let state = loadDay() || defaultState();

  renderAll();
  updateSummary();

  // --- Event bindings ---
  addSetBtn.addEventListener('click', () => {
    state.sets.push(newSet());
    saveDay();
    renderAll();
    updateSummary();
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
  });

  exportBtn.addEventListener('click', () => {
    window.print();
  });

  resetBtn.addEventListener('click', () => {
    const ok = confirm('Reset today? This will clear all sets logged for ' + todayKey + '.');
    if (!ok) return;
    state = defaultState();
    saveDay(true);
    renderAll();
    updateSummary();
  });

  // --- Helpers ---
  function getTodayKey() {
    const d = new Date();
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth() + 1).padStart(2, '0');
    const dd = String(d.getDate()).padStart(2, '0');
    return `${yyyy}-${mm}-${dd}`;
  }

  function defaultState() {
    return {
      date: todayKey,
      sets: [newSet()]
    };
  }

  function newSet() {
    return {
      id: crypto.randomUUID ? crypto.randomUUID() : String(Date.now() + Math.random()),
      createdAt: new Date().toISOString(),
      workDone: false,
      workoutDone: false,
      notes: ''
    };
  }

  function loadDay() {
    try {
      const raw = localStorage.getItem(storageKey);
      if (!raw) return null;
      const parsed = JSON.parse(raw);
      if (parsed && parsed.date === todayKey && Array.isArray(parsed.sets)) return parsed;
      return null;
    } catch (e) {
      console.warn('Failed to load day', e);
      return null;
    }
  }

  function saveDay(clear = false) {
    try {
      if (clear) {
        localStorage.removeItem(storageKey);
      } else {
        localStorage.setItem(storageKey, JSON.stringify(state));
      }
    } catch (e) {
      console.warn('Failed to save day', e);
    }
  }

  function renderAll() {
    setsContainer.innerHTML = '';
    state.sets.forEach((s, idx) => {
      setsContainer.appendChild(renderSet(s, idx));
    });
  }

  function renderSet(s, index) {
    const wrap = document.createElement('div');
    wrap.className = 'set';

    // header
    const header = document.createElement('div');
    header.className = 'set-header';

    const title = document.createElement('div');
    title.className = 'set-title';
    title.textContent = `Set ${index + 1}`;

    const timestamp = document.createElement('div');
    timestamp.className = 'set-time';
    timestamp.textContent = formatTime(s.createdAt);

    header.appendChild(title);
    header.appendChild(timestamp);

    // checks
    const checks = document.createElement('div');
    checks.className = 'checks';

    const workLabel = document.createElement('label');
    const workCheckbox = document.createElement('input');
    workCheckbox.type = 'checkbox';
    workCheckbox.checked = !!s.workDone;
    workCheckbox.addEventListener('change', () => {
      s.workDone = workCheckbox.checked;
      saveDay();
      updateSummary();
    });
    workLabel.appendChild(workCheckbox);
    workLabel.appendChild(document.createTextNode('30-min Work Complete'));

    const workoutLabel = document.createElement('label');
    const workoutCheckbox = document.createElement('input');
    workoutCheckbox.type = 'checkbox';
    workoutCheckbox.checked = !!s.workoutDone;
    workoutCheckbox.addEventListener('change', () => {
      s.workoutDone = workoutCheckbox.checked;
      saveDay();
      updateSummary();
    });
    workoutLabel.appendChild(workoutCheckbox);
    workoutLabel.appendChild(document.createTextNode('Movement / Workout Done'));

    checks.appendChild(workLabel);
    checks.appendChild(workoutLabel);

    // notes
    const notes = document.createElement('textarea');
    notes.placeholder = 'What did you do in this set?';
    notes.value = s.notes || '';
    notes.addEventListener('input', () => {
      s.notes = notes.value;
      saveDay();
    });

    wrap.appendChild(header);
    wrap.appendChild(checks);
    wrap.appendChild(notes);

    return wrap;
  }

  function updateSummary() {
    const total = state.sets.length;
    const workDone = state.sets.filter(s => s.workDone).length;
    const workoutDone = state.sets.filter(s => s.workoutDone).length;

    const hoursFocused = (workDone * 30) / 60;
    const minsFocused = workDone * 30;

    const minsMoved = workoutDone * 5; // if you want to treat each “movement” as 5 min – change as needed
    // Or if movement = ~5 min *per set*, tune logic above. You can also store a duration per set if you want.

    summaryEl.innerHTML = `
      <strong>Today’s Tally</strong><br/>
      Sets logged: <strong>${total}</strong><br/>
      Work sets completed: <strong>${workDone}</strong> (${minsFocused} mins / ${hoursFocused.toFixed(1)} hrs)<br/>
      Movement sets completed: <strong>${workoutDone}</strong> (${workoutDone * 5} mins est.)<br/>
      <span class="mono">${storageKey}</span>
    `;
  }

  function formatTime(iso) {
    try {
      const d = new Date(iso);
      return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    } catch (e) {
      return '';
    }
  }
})();
</script>
</body>
</html>
